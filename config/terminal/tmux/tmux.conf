# Enable mouse support
set -g mouse on

# Set prefix to Ctrl-a (instead of default Ctrl-b)
unbind C-b
set-option -g prefix C-a
bind-key C-a send-prefix

# Split panes using | and -
bind | split-window -h
bind - split-window -v
unbind '"'
unbind %

# Reload config file with prefix + r
bind r source-file ~/.config/tmux/tmux.conf \; display-message "Config reloaded!"

# Switch panes using Alt-arrow without prefix
bind -n M-Left select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up select-pane -U
bind -n M-Down select-pane -D

# Switch windows using h and ; (with prefix)
bind h previous-window
bind \; next-window

# Enable vi mode for copy mode
setw -g mode-keys vi

# Start windows and panes at 1, not 0
set -g base-index 1
setw -g pane-base-index 1

# Renumber windows when one is closed
set -g renumber-windows on

# Set terminal colors
set -g default-terminal "screen-256color"
set -ga terminal-overrides ",*256col*:Tc"

# Increase scrollback buffer size
set -g history-limit 10000

# Display messages for longer
set -g display-time 2000

# Tokyo Night Theme
run-shell "~/.config/tmux/plugins/tokyo-night-tmux/tokyo-night.tmux"

# Apply overrides to fix icon rendering and remove brown colors
run-shell "~/.config/tmux/tokyo-night-override.tmux"

# Tokyo Night configuration options (customize as needed)
# set -g @tokyo-night-tmux_window_id_style digital
# set -g @tokyo-night-tmux_pane_id_style hsquare
# set -g @tokyo-night-tmux_zoom_id_style dsquare

# Show datetime in status bar
# set -g @tokyo-night-tmux_show_datetime 1
# set -g @tokyo-night-tmux_date_format "%Y-%m-%d"
# set -g @tokyo-night-tmux_time_format "%H:%M"

# Show path in status bar
# set -g @tokyo-night-tmux_show_path 1
# set -g @tokyo-night-tmux_path_format relative # 'relative' or 'full'

# Show battery widget (if applicable)
# set -g @tokyo-night-tmux_show_battery_widget 1
# set -g @tokyo-night-tmux_battery_name "BAT1"  # some linux distro have 'BAT0'

# Show network widget
# set -g @tokyo-night-tmux_show_network_widget 1
# set -g @tokyo-night-tmux_network_name "wlo1" # your wifi adapter name

# Show git status widget
# set -g @tokyo-night-tmux_show_git_status_widget 1

# Escape time (for vim compatibility)
set -sg escape-time 0

# Activity monitoring
setw -g monitor-activity on
set -g visual-activity off

# Copy to system clipboard (Linux)
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel 'xclip -in -selection clipboard'
bind -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel 'xclip -in -selection clipboard'

# =============================================================================
# Plugin Configuration
# =============================================================================

# TPM Plugin Manager Configuration
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'

# Tmux Resurrect - Save and restore tmux sessions
set -g @plugin 'tmux-plugins/tmux-resurrect'
# Restore vim/neovim sessions
set -g @resurrect-strategy-vim 'session'
set -g @resurrect-strategy-nvim 'session'
# Restore pane contents
set -g @resurrect-capture-pane-contents 'on'
# Restore shell history
set -g @resurrect-save-shell-history 'on'

# Tmux Continuum - Automatic saving and restoring
set -g @plugin 'tmux-plugins/tmux-continuum'
# Enable automatic restore
set -g @continuum-restore 'on'
# Save session every 15 minutes
set -g @continuum-save-interval '15'
# Optional: Start tmux automatically on boot
# set -g @continuum-boot 'on'

# Initialize TPM (keep this line at the very bottom of tmux.conf)
run '~/.config/tmux/plugins/tpm/tpm'